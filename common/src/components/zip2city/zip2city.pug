include ../form/form

mixin zip2city(data)
  - var data = data || {}
  - var gaz = data.gaz || false

  .c-zip2city(
    data-e-zip2city='{"api": "https://particuliers.engie.fr/sloca-ws/distributeur/recherchecommunes/"}'
    data-e-zip2city-messages='{"errorFormat": "Le code postal doit être un nombre composé de 5 chiffres", "errorNetwork": "Erreur réseau", "errorValidity": "Un code postal existant est obligatoire pour pouvoir continuer"}'
  )
    div
      +label({
        id: "codePostal",
        label: "Code postal"
      })

      +input({
        name: "codePostal",
        id: "codePostal",
        placeholder: "Ex : 75013",
        pattern: "^[0-9]+$",
        maxlength: "5"
      })(
        data-e-zip2city-zip
        aria-describedby="codePostal-error"
      )

      #codePostal-error(
        data-e-zip2city-error
        aria-live="polite"
      )

    div
      +label({
        id: "commune",
        label: "Commune"
      })
      div(data-e-zip2city-place)
        +input({
          name: "commune",
          id: "commune"
        })(disabled='true')

    if gaz
      div(data-e-zip2city-hasgaz='{"yes": "Votre commune est raccordée au réseau de distribution de GrDF. Vous pouvez faire votre demande de raccordement.", "no": "Votre commune n\'est pas raccordée au réseau de distribution de GrDF."}')